---
title: "State Determinants Visualization"
output: html_document
---

This notebook can be used to reproduce the visualizations for the social determinants of each state. States that did not have enough data were UT, VT, DE, ME, MD, MA, NH, and NJ. States that currently do not work are AK, MI, RI, and WY.

from ProtoNotebook
```{r echo = F}

#### Library and Data Imports ####
## Load essential R packages
source("Modules/Source.R")
## Load in model outputs per state:
source("Modules/load_model_output.R")

```

from ProtoNotebook
```{r echo = F}

  # use GWAS_ADJ_P and GWAS_MRR to say for which states there are significant protective and destructive variables

  s = ""
  for (state in colnames(GWAS_MRR)) {
    s <- paste(s, state, ": ", sep = "")
    
    prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          #des <- c(des, GWAS_MRR[[state]][itr])
          des <- c(des, itr)
        } else {
          #prt <- c(prt, GWAS_MRR[[state]][itr])
          prt <- c(prt, itr)
        }
      }
    }
  
    if (length(prt) > 1) {
      s <- paste(s, "protective variables include: ", sep = "")
      for ( i  in 2:length(prt) ) {
        if (i != length(prt)) {
          s <- paste(s, colnames(model_input)[prt[i]], ", ", sep = "")
        } else {
          s <- paste(s, colnames(model_input)[prt[i]], " ", sep = "")
        }
      }
    } else {
      s <- paste(s, "no protective variables; ", sep = "")
    }
    
    if (length(des) > 1) {
      s <- paste(s, "destructive variables include: ", sep = "")
      for ( i  in 2:length(des) ) {
        if (i != length(des)) {
          s <- paste(s, colnames(model_input)[des[i]], ", ", sep = "")
        } else {
          s <- paste(s, colnames(model_input)[des[i]], "", sep = "")
        }
      }
    } else {
      s <- paste(s, "no destructive variables;", sep = "")
    }
    
    s <- paste(s, "\n", sep ="")
  }

  cat(s)


```

Start of State Visualization

Alabama
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
#select state  
  state = "AL"
  state
#sorts determinants as protective or destructive
   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

#create data frame    
    dataAL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAL <- dataAL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAL$y <- factor(dataAL$y, levels = dataAL$y)

#round MRR to 2 decimal places
x <- dataAL$x
x_num<-round(x,digits=2)
dataAL$x_round = x_num

#plot
p<- ggplot(dataAL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="black", size=3.5)
}
p
ggsave("AL_desprt.png")
```

Alaska (not enough)

Arizona (MAKE LOOK NEATER)
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "AZ"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataAZ <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAZ <- dataAZ %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAZ$y <- factor(dataAZ$y, levels = dataAZ$y)

#plot
x <- dataAZ$x
x_num<-round(x,digits=2)
dataAZ$x_round = x_num

p<-ggplot(dataAZ, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=5, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x), vjust=0.5,color="black", size=3.5)
}
p
ggsave("AZ_desprt.png")
```

Arkansas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "AR"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataAR <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataAR <- dataAR %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataAR$y <- factor(dataAR$y, levels = dataAR$y)

#plot
x <- dataAR$x
x_num<-round(x,digits=2)
dataAR$x_round = x_num

p<-ggplot(dataAR, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("AR_desprt.png")
```

California
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "CA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataCA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataCA <- dataCA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataCA$y <- factor(dataCA$y, levels = dataCA$y)

# dataCApos <- dataCA[ which(dataCA$'Effect on MRR' =='Protective'), ]
# dataCApos[sapply(dataCApos, is.numeric)] <- dataCApos[sapply(dataCApos, is.numeric)] * -1
# dataCA <-rbind(dataCA, dataCApos)
# dataCA<-dataCA[!(dataCA$x>= 0 | dataCA$`Effect on MRR`=="Protective"),]

#plot
x <- dataCA$x
x_num<-round(x,digits=2)
dataCA$x_round = x_num

p<-ggplot(dataCA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("CA_desprt.png")
```

Colorado
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "CO"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataCO <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataCO <- dataCO %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataCO$y <- factor(dataCO$y, levels = dataCO$y)

#plot
x <- dataCO$x
x_num<-round(x,digits=2)
dataCO$x_round = x_num

p<-ggplot(dataCO, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("CO_desprt.png")
```

Connecticut (Insufficient data or no protective or destructive variables in this state)
Delaware (Insufficient data or no protective or destructive variables in this state)

Florida
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "FL"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataFL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataFL <- dataFL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataFL$y <- factor(dataFL$y, levels = dataFL$y)

#plot
x <- dataFL$x
x_num<-round(x,digits=2)
dataFL$x_round = x_num

p<-ggplot(dataFL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("FL_desprt.png")
```

Georgia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "GA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataGA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataGA <- dataGA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataGA$y <- factor(dataGA$y, levels = dataGA$y)

#plot
x <- dataGA$x
x_num<-round(x,digits=2)
dataGA$x_round = x_num

p<-ggplot(dataGA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("GA_desprt.png")
```

Hawaii (Insufficient data or no protective or destructive variables in this state)

Idaho  
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "ID"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataID <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataID <- dataID %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataID$y <- factor(dataID$y, levels = dataID$y)

#plot
x <- data$x
x_num<-round(x,digits=2)
data$x_round = x_num

ggplot(data, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}

ggsave("ID_desprt.png")
```

Illinois
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IL"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIL <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIL <- dataIL %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIL$y <- factor(dataIL$y, levels = dataIL$y)

#plot
x <- dataIL$x
x_num<-round(x,digits=2)
dataIL$x_round = x_num

p<-ggplot(dataIL, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("IL_desprt.png")
```

Indiana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIN <- dataIN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIN$y <- factor(dataIN$y, levels = dataIN$y)

#plot
x <- dataIN$x
x_num<-round(x,digits=2)
dataIN$x_round = x_num

p<-ggplot(dataIN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("IN_desprt.png")
```

Iowa
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "IA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataIA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataIA <- dataIA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataIA$y <- factor(dataIA$y, levels = dataIA$y)

#plot
x <- dataIA$x
x_num<-round(x,digits=2)
dataIA$x_round = x_num

p<-ggplot(dataIA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("IA_desprt.png")
```

Kansas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "KS"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataKS <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataKS <- dataKS %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataKS$y <- factor(dataKS$y, levels = dataKS$y)

#plot
x <- dataKS$x
x_num<-round(x,digits=2)
dataKS$x_round = x_num

p<-ggplot(dataKS, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("KS_desprt.png")
```

Kentucky
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "KY"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataKY <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataKY <- dataKY %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataKY$y <- factor(dataKY$y, levels = dataKY$y)

#plot
x <- dataKY$x
x_num<-round(x,digits=2)
dataKY$x_round = x_num

p<-ggplot(dataKY, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("KY_desprt.png")
```

Louisiana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "LA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataLA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataLA <- dataLA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataLA$y <- factor(dataLA$y, levels = dataLA$y)

#plot
x <- dataLA$x
x_num<-round(x,digits=2)
dataLA$x_round = x_num

p<-ggplot(dataLA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("LA_desprt.png")
```

Maine (not enough)
Maryland (not enough)
Massachusetts (not enough)

Michigan
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MI"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMI <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMI <- dataMI %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMI$y <- factor(dataMI$y, levels = dataMI$y)

#plot
x <- dataMI$x
x_num<-round(x,digits=2)
dataMI$x_round = x_num

p<-ggplot(dataMI, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("MI_desprt.png")
```

Minnesota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMN <- dataMN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMN$y <- factor(dataMN$y, levels = dataMN$y)

#plot
x <- dataMN$x
x_num<-round(x,digits=2)
dataMN$x_round = x_num

p<-ggplot(dataMN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("MN_desprt.png")
```

Mississippi
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MS"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMS <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMS <- dataMS %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMS$y <- factor(dataMS$y, levels = dataMS$y)

#plot
x <- dataMS$x
x_num<-round(x,digits=2)
dataMS$x_round = x_num

p<-ggplot(dataMS, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("MS_desprt.png")
```

Missouri
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MO"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMO <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMO <- dataMO %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMO$y <- factor(dataMO$y, levels = dataMO$y)

#plot
x <- dataMO$x
x_num<-round(x,digits=2)
dataMO$x_round = x_num

p<-ggplot(dataMO, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("MO_desprt.png")
```

Montana
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "MT"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataMT <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataMT <- dataMT %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataMT$y <- factor(dataMT$y, levels = dataMT$y)

#plot
x <- dataMT$x
x_num<-round(x,digits=2)
dataMT$x_round = x_num

p<-ggplot(dataMT, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("MT_desprt.png")
```

Nebraska
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NE"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNE <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNE <- dataNE %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNE$y <- factor(dataNE$y, levels = dataNE$y)

#plot
x <- dataNE$x
x_num<-round(x,digits=2)
dataNE$x_round = x_num

p<-ggplot(dataNE, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("NE_desprt.png")
```

Nevada (not enough)
New Hampshire (not enough)
New Jersey (not enough)

New Mexico
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NM"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNM <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNM <- dataNM %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNM$y <- factor(dataNM$y, levels = dataNM$y)

#plot
x <- dataNM$x
x_num<-round(x,digits=2)
dataNM$x_round = x_num

p<-ggplot(dataNM, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("NM_desprt.png")
```

New York
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NY"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNY <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNY <- dataNY %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNY$y <- factor(dataNY$y, levels = dataNY$y)

#plot
x <- dataNY$x
x_num<-round(x,digits=2)
dataNY$x_round = x_num

p<-ggplot(dataNY, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("NY_desprt.png")
```

North Carolina
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "NC"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataNC <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataNC <- dataNC %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataNC$y <- factor(dataNC$y, levels = dataNC$y)

#plot
x <- dataNC$x
x_num<-round(x,digits=2)
dataNC$x_round = x_num

p<-ggplot(dataNC, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("NC_desprt.png")
```


North Dakota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "ND"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataND <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataND <- dataND %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataND$y <- factor(dataND$y, levels = dataND$y)

#plot
x <- dataND$x
x_num<-round(x,digits=2)
dataND$x_round = x_num

p<-ggplot(dataND, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("ND_desprt.png")
```

Ohio
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "OH"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOH <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOH <- dataOH %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOH$y <- factor(dataOH$y, levels = dataOH$y)

#plot
x <- dataOH$x
x_num<-round(x,digits=2)
dataOH$x_round = x_num

p<-ggplot(dataOH, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("OH_desprt.png")
```

Oklahoma
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = ""
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOK <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOK <- dataOK %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOK$y <- factor(dataOK$y, levels = dataOK$y)

#plot
x <- dataOK$x
x_num<-round(x,digits=2)
dataOK$x_round = x_num

p<-ggplot(dataOK, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("OK_desprt.png")
```

Oregan 
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "OR"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataOR <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataOR <- dataOR %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataOR$y <- factor(dataOR$y, levels = dataOR$y)

#plot
x <- dataOR$x
x_num<-round(x,digits=2)
dataOR$x_round = x_num

p<-ggplot(dataOR, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("OR_desprt.png")
```

Pennsylvania
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "PA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataPA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataPA <- dataPA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataPA$y <- factor(dataPA$y, levels = dataPA$y)

#plot
x <- dataPA$x
x_num<-round(x,digits=2)
dataPA$x_round = x_num

p<- ggplot(dataPA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_round), vjust=0.5,color="black", size=3.5)

ggplot(dataPA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +  
  scale_color_manual(values = c("#bd0026", "#253494")) +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle("PA Protective and Destructive Variables") +
  geom_text(aes(label=x_round, colour=x_round<1), vjust=0.5,color="black", size=3.5,nudge_x = -0.15)


}
p
ggsave("PA_desprt.png")
```

Rhode Island (not enough)

South Carolina
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "SC"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataSC <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataSC <- dataSC %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataSC$y <- factor(dataSC$y, levels = dataSC$y)

#plot
x <- dataSC$x
x_num<-round(x,digits=2)
dataSC$x_round = x_num

p<-ggplot(dataSC, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("SC_desprt.png")
```

South Dakota
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "SD"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataSD <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataSD <- dataSD %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataSD$y <- factor(dataSD$y, levels = dataSD$y)

#plot
x <- dataSD$x
x_num<-round(x,digits=2)
dataSD$x_round = x_num

p<-ggplot(dataSD, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("SD_desprt.png")
```

Tennessee
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "TN"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataTN <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataTN <- dataTN %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataTN$y <- factor(dataTN$y, levels = dataTN$y)

#plot
x <- dataTN$x
x_num<-round(x,digits=2)
dataTN$x_round = x_num

p<-ggplot(dataTN, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("TN_desprt.png")
```

Texas
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "TX"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataTX <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataTX <- dataTX %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataTX$y <- factor(dataTX$y, levels = dataTX$y)

#plot
x <- dataTX$x
x_num<-round(x,digits=2)
dataTX$x_round = x_num

p<-ggplot(dataTX, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("TX_desprt.png")
```

Utah (not enough)
Vermont(not enough)

Virginia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "VA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataVA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataVA <- dataVA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataVA$y <- factor(dataVA$y, levels = dataVA$y)

#plot
x <- dataVA$x
x_num<-round(x,digits=2)
dataVA$x_round = x_num

p<-ggplot(dataVA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("VA_desprt.png")
```

Washington
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WA"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWA <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWA <- dataWA %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWA$y <- factor(dataWA$y, levels = dataWA$y)

#plot
x <- dataWA$x
x_num<-round(x,digits=2)
dataWA$x_round = x_num

p<-ggplot(dataWA, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("WA_desprt.png")
```

West Virginia
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WV"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWV <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWV <- dataWV %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWV$y <- factor(dataWV$y, levels = dataWV$y)

#plot
x <- dataWV$x
x_num<-round(x,digits=2)
dataWV$x_round = x_num

p<-ggplot(dataWV, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("WV_desprt.png")
```


Wisconsin
```{r echo = F}
  # Libraries
  library(ggplot2)
# Create data

for (state in colnames(GWAS_MRR)) {
  
  state = "WI"
  state

   prt <- c(NA)
    des <- c(NA)
    for (itr in 1:length(GWAS_ADJ_P[[state]])) {
      if (is.na(GWAS_ADJ_P[[state]][itr]) == FALSE  && GWAS_ADJ_P[[state]][itr] < 0.05 ) {
        if (is.na(GWAS_MRR[[state]][itr]) == FALSE  &&  GWAS_MRR[[state]][itr]  >= 1.0 ) {
          des <- c(des, itr)
        } else {
          prt <- c(prt, itr)
        }
      }
    }
    #prt[2:length(prt)]
    vals  <- c(NA)
    names <- c(NA)
    if (length(prt) > 1){
      names <- colnames(model_input)[prt[2:length(prt)]]
      vals <- GWAS_MRR[[state]][prt[2:length(prt)]]
    }
    if (length(des) > 1){
      names <- c(names, colnames(model_input)[des[2:length(des)]])
      vals <- c(vals, GWAS_MRR[[state]][des[2:length(des)]])
    }
    
    if (length(names) == 1) {
      print("Insufficient data or no protective or destructive variables in this state.")
      next
    }

    
    dataWI <- data.frame(
      y=names[2:length(names)], 
      x=vals[2:length(names)]
    )
    
    #view(data)
    title <- paste(state, " Protective and Destructive Variables", sep = "")
    dataWI <- dataWI %>% 
      mutate(`Effect on MRR` = ifelse(x<1,"Protective", "Destructive"))
     
    dataWI$y <- factor(dataWI$y, levels = dataWI$y)

#plot
x <- dataWI$x
x_num<-round(x,digits=2)
dataWI$x_round = x_num

p<-ggplot(dataWI, aes(x=x, y=y)) +
  geom_segment( aes(x=x, xend=1, y=y, yend=y, color = `Effect on MRR`), size=12, alpha=0.9 ) +      
  scale_color_manual(values = c("#bd0026", "#253494")) +
  #      geom_point() +
  ylab("Interested Variable") +
  xlab("MRR of Interested Variable") +
  ggtitle(title) +
  geom_text(aes(label=x_num), vjust=0.5,color="black", size=3.5)
}
p
ggsave("WI_desprt.png")
```

National GWAS
GWAS_MRR
GWAS_ADJ_P

```{r echo = F}
library(ggplot2)

##National Determinants
#data from GWAS_ADJ_P and GWAS_MRR
GWAS_ADJ_P
#remove rows 1-14 
GWAS_ADJ_P_interested <- GWAS_ADJ_P[-c(1:14), ]
#GWAS_ADJ_P_t<-t(GWAS_ADJ_P_interested)
#convert to data frame
GWAS_ADJ_P_t <- as.data.frame(t(GWAS_ADJ_P_interested))
#find significant determinants and create data frame with them
GWAS_ADJ_P_signficant <- subset(GWAS_ADJ_P_t,  Interested_Variable < 0.05)
#GWAS_ADJ_P_signficant <- subset(GWAS_ADJ_P_signficant,  Interested_Variable > 0)
#rownames(GWAS_ADJ_P_t)

GWAS_MRR
#remove rows 1-14
GWAS_MRR_interested <- GWAS_MRR[-c(1:14), ]
#convert to data frame
GWAS_MRR_t <- as.data.frame(t(GWAS_MRR_interested))
GWAS_MRR_T < -exp(GWAS_MRR_t)

#merge GWAS_ADJ and GWAS_MRR data
GWAS_data <- merge(GWAS_ADJ_P_signficant, GWAS_MRR_T, by = 0) 
#mutliply GWAS_MRR data by 100
GWAS_data$MRRX100 <- GWAS_data$Interested_Variable.y * 100 
GWAS_data <- GWAS_data[-c(7),] 

#convert MRRX100 as numeric and Row.names as characters
GWAS_data$MRRX100 <- as.numeric(as.character(GWAS_data$MRRX100))
GWAS_data
GWAS_data$Row.names <- as.character(GWAS_data$Row.names)

GWAS_data$Row.names <- as.character(GWAS_data$Row.names)
GWAS_data$Row.names[GWAS_data$Row.names == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
GWAS_data$Row.names[GWAS_data$Row.names == "Average Number of Physically Unhealthy Days"] <- "Avg. Number of Physically Unhealthy Days"
GWAS_data$Row.names[GWAS_data$Row.names == "Cancer.death_rate"] <- "Cancer Death Rate"
GWAS_data$Row.names[GWAS_data$Row.names == "% Vaccinated"] <- "% Flu Vaccinated Medicare FFS"
GWAS_data$Row.names[GWAS_data$Row.names == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
GWAS_data$Row.names[GWAS_data$Row.names == "Average Grade Performance"] <- "Avg. Grade Performance"

#orders data from highest to lowest value
GWAS_data$Row.names <- factor(GWAS_data$Row.names, levels = GWAS_data$Row.names[order(GWAS_data$MRRX100)])

#round MRRX100 to 2 decimal places for better viewing
MRRX100 <- GWAS_data$MRRX100
GWAS_data$MRRX100 <- MRRX100 -100
MRRX100_num<-round(GWAS_data$MRRX100,digits=2)
GWAS_data$MRRX100_round = MRRX100_num

#plot
# ggplot(GWAS_data, aes(x=Row.names, y=MRRX100)) +
#    ggtitle("Significant National Social Determinants")+
#    xlab("Significant Determinants") +
#    ylab("Mortality Rate Ratio") +
#    geom_bar(stat = "identity",aes(fill=MRRX100<0)) +
#    coord_flip()+
#    theme(legend.position='none')+
#    scale_fill_manual(values = c("#bd0026", "#253494"))+
#    geom_text(aes(label=MRRX100_round), vjust=0.5,color="black", size=3.5, nudge_y = 2.75)

 ggplot(GWAS_data, aes(x=Row.names, y=MRRX100)) +
   ggtitle("Significant National Social Determinants")+
   xlab("Significant Determinants") +
   ylab("Mortality Rate Ratio") +
   geom_bar(stat = "identity",aes(fill=MRRX100_round<0)) +
   coord_flip()+
   theme(legend.position='none')+
   scale_fill_manual(values = c("#bd0026", "#253494"))+
   geom_text(aes(label=MRRX100_round, colour =MRRX100_round <0), vjust=0.5, size=3.5, nudge_y = 3)+
   scale_colour_manual(values=c("#000000","#FFFFFF"))

ggsave("national_sd.png")
```

```{r}
##National Coefficients
#Output Wald-test p-values
high_risk_p <- as.data.frame(summary(high.risk.model)[10]$coefficients[2:25,4])
high_risk_p_signficant <- subset(high_risk_p,  high_risk_p$`summary(high.risk.model)[10]$coefficients[2:25, 4]` < 0.05)

#Output MRR
high_risk_MRR <- as.data.frame(exp(summary(high.risk.model)[10]$coefficients[2:25,1]))

#merge high_risk_p and high_rish_mrr
high_risk_data <- merge(high_risk_p_signficant, high_risk_MRR, by = 0) 
#mutliply GWAS_MRR data by 100
high_risk_data$MRRX100 <- high_risk_data$`exp(summary(high.risk.model)[10]$coefficients[2:25, 1])` * 100 

#convert MRRX100 as numeric and Row.names as characters
high_risk_data$MRRX100 <- as.numeric(as.character(high_risk_data$MRRX100))
high_risk_data$Row.names <- as.character(high_risk_data$Row.names)

#change coefficient names for readibility
high_risk_data$Row.names <- as.character(high_risk_data$Row.names)
high_risk_data$Row.names[high_risk_data$Row.names == "scale(date_since_mask)"] <- "Days Since Mask Required"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(AdultAsthma)"] <- "% Adult Asthma"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(date_since)"] <- "Days Since First Infection"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(education)"] <- "% with less than High-School Education"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(hispanic)"] <- "% Hispanic in County"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(log(medhouseholdincome))"] <- "Median Household Income"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(LungCancer)"] <- "% with Lung Cancer"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_asian)"] <- "% Asian"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_blk)"] <- "% African American"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_native)"] <- "% Native American"

#orders data from highest to lowest value
high_risk_data$Row.names <- factor(high_risk_data$Row.names, levels = high_risk_data$Row.names[order(high_risk_data$MRRX100)])

#round MRRX100 to 2 decimal places for better viewing
hrmMRRX100 <- high_risk_data$MRRX100
hrmMRRX100_minus <- hrmMRRX100 - 100
high_risk_data$MRRX100 <- hrmMRRX100_minus
hrmMRRX100_num<-round(hrmMRRX100_minus,digits=2)
high_risk_data$MRRX100_round = hrmMRRX100_num

ggplot(high_risk_data, aes(x=Row.names, y=MRRX100)) +
   ggtitle("Significant National Coefficients")+
   xlab("Significant Coefficients") +
   ylab("Mortality Rate Ratio") +
   geom_bar(stat = "identity",aes(fill=MRRX100<0)) +
   coord_flip()+
   theme(legend.position='none')+
   scale_fill_manual(values = c("#bd0026", "#253494"))+
   geom_text(aes(label=MRRX100_round, colour =MRRX100_round <0), vjust=0.5, size=3.5, nudge_y = 7.0)+
   scale_colour_manual(values=c("#000000","#FFFFFF"))

ggsave("national_coefficients.png")
```


Combinded Graph of Coefficients and Determinants(to be used in COVIDMINDER)
```{r}
library(dplyr)
library(ggplot2)

##National Determinants
#data from GWAS_ADJ_P and GWAS_MRR
GWAS_ADJ_P
#remove rows 1-14 
GWAS_ADJ_P_interested <- GWAS_ADJ_P[-c(1:14), ]
#GWAS_ADJ_P_t<-t(GWAS_ADJ_P_interested)
#convert to data frame
GWAS_ADJ_P_t <- as.data.frame(t(GWAS_ADJ_P_interested))
#find significant determinants and create data frame with them
GWAS_ADJ_P_signficant <- subset(GWAS_ADJ_P_t,  Interested_Variable < 0.05)
#GWAS_ADJ_P_signficant <- subset(GWAS_ADJ_P_signficant,  Interested_Variable > 0)
#rownames(GWAS_ADJ_P_t)

GWAS_MRR
#remove rows 1-14
GWAS_MRR_interested <- GWAS_MRR[-c(1:14), ]
#convert to data frame
GWAS_MRR_t <- as.data.frame(t(GWAS_MRR_interested))
GWAS_MRR_T < -exp(GWAS_MRR_t)

#merge GWAS_ADJ and GWAS_MRR data
GWAS_data <- merge(GWAS_ADJ_P_signficant, GWAS_MRR_T, by = 0) 
#mutliply GWAS_MRR data by 100
GWAS_data$MRRX100 <- GWAS_data$Interested_Variable.y * 100 
GWAS_data <- GWAS_data[-c(7),] 

#convert MRRX100 as numeric and Row.names as characters
GWAS_data$MRRX100 <- as.numeric(as.character(GWAS_data$MRRX100))
GWAS_data
GWAS_data$Row.names <- as.character(GWAS_data$Row.names)

GWAS_data$Row.names <- as.character(GWAS_data$Row.names)
GWAS_data$Row.names[GWAS_data$Row.names == "Average Daily PM2.5"] <- "Avg. Daily Air Pollution (PM2.5)"
GWAS_data$Row.names[GWAS_data$Row.names == "Average Number of Physically Unhealthy Days"] <- "Avg. Numer of Physically Unhealthy Days"
GWAS_data$Row.names[GWAS_data$Row.names == "Cancer.death_rate"] <- "Cancer Death Rate"
GWAS_data$Row.names[GWAS_data$Row.names == "% Vaccinated"] <- "% Flu Vaccinated Medicare FFS"
GWAS_data$Row.names[GWAS_data$Row.names == "Suicide Rate (Age-Adjusted)"] <- "Age-Adjusted Suicide Rate"
GWAS_data$Row.names[GWAS_data$Row.names == "Average Grade Performance"] <- "Avg. Grade Performance"

#orders data from highest to lowest value
GWAS_data$Row.names <- factor(GWAS_data$Row.names, levels = GWAS_data$Row.names[order(GWAS_data$MRRX100)])

#round MRRX100 to 2 decimal places for better viewing
MRRX100 <- GWAS_data$MRRX100
GWAS_data$MRRX100 <- MRRX100 -100
MRRX100_num<-round(GWAS_data$MRRX100,digits=2)
GWAS_data$MRRX100_round = MRRX100_num

##National Coefficients (data from High Risk Model Notebook)
#Output Wald-test p-values
high_risk_p <- readRDS('data/high.risk.model_P.Rds')
#high_risk_p <- as.data.frame(summary(high.risk.model)[10]$coefficients[2:25,4])
high_risk_p_signficant <- subset(high_risk_p,  high_risk_p$`summary(high.risk.model)[10]$coefficients[2:25, 4]` < 0.05)

#Output MRR
high_risk_MRR <- readRDS('data/high.risk.model_MRR.Rds')
#high_risk_MRR <- as.data.frame(exp(summary(high.risk.model)[10]$coefficients[2:25,1]))

#merge high_risk_p and high_rish_mrr
high_risk_data <- merge(high_risk_p_signficant, high_risk_MRR, by = 0) 
#mutliply GWAS_MRR data by 100
high_risk_data$MRRX100 <- high_risk_data$`exp(summary(high.risk.model)[10]$coefficients[2:25, 1])` * 100 

#convert MRRX100 as numeric and Row.names as characters
high_risk_data$MRRX100 <- as.numeric(as.character(high_risk_data$MRRX100))
high_risk_data$Row.names <- as.character(high_risk_data$Row.names)

#change coefficient names for readibility
high_risk_data$Row.names <- as.character(high_risk_data$Row.names)
high_risk_data$Row.names[high_risk_data$Row.names == "scale(date_since_mask)"] <- "Days Since Mask Required"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(AdultAsthma)"] <- "% Adult Asthma"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(date_since)"] <- "Days Since First Infection"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(education)"] <- "% with less than High-School Education"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(hispanic)"] <- "% Hispanic in County"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(log(medhouseholdincome))"] <- "Median Household Income"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(LungCancer)"] <- "% with Lung Cancer"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_asian)"] <- "% Asian"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_blk)"] <- "% African American"
high_risk_data$Row.names[high_risk_data$Row.names == "scale(pct_native)"] <- "% Native American"
combinded_determinants_data$Row.names[GWAS_data$Row.names == "Overcrowding"] <- "% Overcrowded Housing"


#orders data from highest to lowest value
high_risk_data$Row.names <- factor(high_risk_data$Row.names, levels = high_risk_data$Row.names[order(high_risk_data$MRRX100)])

#round MRRX100 to 2 decimal places for better viewing
hrmMRRX100 <- high_risk_data$MRRX100
hrmMRRX100_minus <- hrmMRRX100 - 100
high_risk_data$MRRX100 <- hrmMRRX100_minus
hrmMRRX100_num<-round(hrmMRRX100_minus,digits=2)
high_risk_data$MRRX100_round = hrmMRRX100_num

##Combinded Coefficients and Determinants
#change column names in high_risk_data dataframe
names(high_risk_data)[names(high_risk_data) == "summary(high.risk.model)[10]$coefficients[2:25, 4]"] <- "Interested_Variable.x"
names(high_risk_data)[names(high_risk_data) == "exp(summary(high.risk.model)[10]$coefficients[2:25, 1])"] <- "Interested_Variable.y"

#combine GWAS_data and high_risk_data
combinded_determinants_data <- rbind(GWAS_data, high_risk_data)

#orders data from highest to lowest value
combinded_determinants_data$Row.names <- factor(combinded_determinants_data$Row.names, levels = combinded_determinants_data$Row.names[order(combinded_determinants_data$MRRX100)])

#plot
ggplot(combinded_determinants_data, aes(x=Row.names, y=MRRX100)) +
   ggtitle("Significant National Determinants")+
   xlab("Significant Determinants") +
   ylab("Mortality Rate Ratio") +
   geom_bar(stat = "identity",aes(fill=MRRX100<0)) +
   coord_flip()+
   theme(legend.position='none')+
   scale_fill_manual(values = c("#bd0026", "#253494"))+
   geom_text(aes(label=MRRX100_round, colour =MRRX100_round <0), vjust=0.5, size=3.0, nudge_y = 6.7)+
   scale_colour_manual(values=c("#000000","#FFFFFF"))

ggsave("combinded_determinants.png")
```